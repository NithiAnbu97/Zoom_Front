{"ast":null,"code":"import _slicedToArray from\"D:/Batch 32/Batch 32/Projects/Final Output/Zoom_Front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{createContext,useState,useRef,useEffect}from\"react\";import{io}from\"socket.io-client\";import Peer from\"simple-peer\";import{jsx as _jsx}from\"react/jsx-runtime\";var SocketContext=/*#__PURE__*/createContext();var socket=io(\"https://zoom-clone-back.herokuapp.com/\");var ContextProvider=function ContextProvider(_ref){var children=_ref.children;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),stream=_useState2[0],setStream=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),me=_useState4[0],setMe=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),call=_useState6[0],setCall=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),callAccepted=_useState8[0],setCallAccepted=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),callEnded=_useState10[0],setCallEnded=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),name=_useState12[0],setName=_useState12[1];var myVideo=useRef();var userVideo=useRef();var connectionRef=useRef();//to get the permission for the audio and video and to stream\nuseEffect(function(){navigator.mediaDevices.getUserMedia({video:true,audio:true}).then(function(currentStream){setStream(currentStream);myVideo.current.srcObject=currentStream;});socket.on(\"me\",function(id){setMe(id);});socket.on(\"calluser\",function(_ref2){var from=_ref2.from,callerName=_ref2.name,signal=_ref2.signal;setCall({isReceivedCall:true,from:from,name:callerName,signal:signal});});},[]);//streaming\nvar answerCall=function answerCall(){setCallAccepted(true);var peer=new Peer({initiator:false,trickle:false,stream:stream});peer.on(\"signal\",function(data){socket.emit(\"answerCall\",{signal:data,to:call.from});});peer.on(\"stream\",function(currentStream){userVideo.current.srcObject=currentStream;});peer.signal(call.signal);connectionRef.current=peer;};//for streaming \nvar callUser=function callUser(id){var peer=new Peer({initiator:true,trickle:false,stream:stream});peer.on(\"signal\",function(data){socket.emit(\"calluser\",{userToCall:id,signalData:data,from:me,name:name});});peer.on(\"stream\",function(currentStream){userVideo.current.srcObject=currentStream;});socket.on(\"callaccepted\",function(signal){setCallAccepted(true);peer.signal(signal);});connectionRef.current=peer;};//to disconnect the call\nvar leaveCall=function leaveCall(){setCallEnded(true);connectionRef.current.destroy();window.location.reload();};return/*#__PURE__*/_jsx(SocketContext.Provider,{value:{call:call,callAccepted:callAccepted,callEnded:callEnded,me:me,myVideo:myVideo,userVideo:userVideo,stream:stream,name:name,setName:setName,callUser:callUser,leaveCall:leaveCall,answerCall:answerCall},children:children});};export{ContextProvider,SocketContext};","map":{"version":3,"sources":["D:/Batch 32/Batch 32/Projects/Final Output/Zoom_Front/src/SocketContext.js"],"names":["React","createContext","useState","useRef","useEffect","io","Peer","SocketContext","socket","ContextProvider","children","stream","setStream","me","setMe","call","setCall","callAccepted","setCallAccepted","callEnded","setCallEnded","name","setName","myVideo","userVideo","connectionRef","navigator","mediaDevices","getUserMedia","video","audio","then","currentStream","current","srcObject","on","id","from","callerName","signal","isReceivedCall","answerCall","peer","initiator","trickle","data","emit","to","callUser","userToCall","signalData","leaveCall","destroy","window","location","reload"],"mappings":"4KAAA,MAAOA,CAAAA,KAAP,EAAgBC,aAAhB,CAA+BC,QAA/B,CAAyCC,MAAzC,CAAiDC,SAAjD,KAAkE,OAAlE,CACA,OAASC,EAAT,KAAmB,kBAAnB,CACA,MAAOC,CAAAA,IAAP,KAAiB,aAAjB,C,2CAEA,GAAMC,CAAAA,aAAa,cAAGN,aAAa,EAAnC,CAEA,GAAMO,CAAAA,MAAM,CAAGH,EAAE,CAAC,wCAAD,CAAjB,CAEA,GAAMI,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,MAAkB,IAAfC,CAAAA,QAAe,MAAfA,QAAe,CAEtC,cAA4BR,QAAQ,CAAC,IAAD,CAApC,wCAAOS,MAAP,eAAeC,SAAf,eACA,eAAoBV,QAAQ,CAAC,EAAD,CAA5B,yCAAOW,EAAP,eAAWC,KAAX,eACA,eAAwBZ,QAAQ,CAAC,EAAD,CAAhC,yCAAOa,IAAP,eAAaC,OAAb,eACA,eAAwCd,QAAQ,CAAC,KAAD,CAAhD,yCAAOe,YAAP,eAAqBC,eAArB,eACA,eAAkChB,QAAQ,CAAC,KAAD,CAA1C,0CAAOiB,SAAP,gBAAkBC,YAAlB,gBACA,gBAAwBlB,QAAQ,CAAC,EAAD,CAAhC,2CAAOmB,IAAP,gBAAaC,OAAb,gBAEA,GAAMC,CAAAA,OAAO,CAAGpB,MAAM,EAAtB,CACA,GAAMqB,CAAAA,SAAS,CAAGrB,MAAM,EAAxB,CACA,GAAMsB,CAAAA,aAAa,CAAGtB,MAAM,EAA5B,CAEA;AACAC,SAAS,CAAC,UAAM,CACZsB,SAAS,CAACC,YAAV,CAAuBC,YAAvB,CAAoC,CAAEC,KAAK,CAAE,IAAT,CAAeC,KAAK,CAAE,IAAtB,CAApC,EACKC,IADL,CACU,SAACC,aAAD,CAAmB,CACrBpB,SAAS,CAACoB,aAAD,CAAT,CACAT,OAAO,CAACU,OAAR,CAAgBC,SAAhB,CAA4BF,aAA5B,CACH,CAJL,EAMAxB,MAAM,CAAC2B,EAAP,CAAU,IAAV,CAAgB,SAACC,EAAD,CAAQ,CACpBtB,KAAK,CAACsB,EAAD,CAAL,CACH,CAFD,EAIA5B,MAAM,CAAC2B,EAAP,CAAU,UAAV,CAAsB,eAAwC,IAArCE,CAAAA,IAAqC,OAArCA,IAAqC,CAAzBC,UAAyB,OAA/BjB,IAA+B,CAAbkB,MAAa,OAAbA,MAAa,CAC1DvB,OAAO,CAAC,CAAEwB,cAAc,CAAE,IAAlB,CAAwBH,IAAI,CAAJA,IAAxB,CAA8BhB,IAAI,CAAEiB,UAApC,CAAgDC,MAAM,CAANA,MAAhD,CAAD,CAAP,CACH,CAFD,EAGH,CAdQ,CAcN,EAdM,CAAT,CAgBA;AACA,GAAME,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACrBvB,eAAe,CAAC,IAAD,CAAf,CAEA,GAAMwB,CAAAA,IAAI,CAAG,GAAIpC,CAAAA,IAAJ,CAAS,CAAEqC,SAAS,CAAE,KAAb,CAAoBC,OAAO,CAAE,KAA7B,CAAoCjC,MAAM,CAANA,MAApC,CAAT,CAAb,CAEA+B,IAAI,CAACP,EAAL,CAAQ,QAAR,CAAkB,SAACU,IAAD,CAAU,CACxBrC,MAAM,CAACsC,IAAP,CAAY,YAAZ,CAA0B,CAAEP,MAAM,CAAEM,IAAV,CAAgBE,EAAE,CAAEhC,IAAI,CAACsB,IAAzB,CAA1B,EACH,CAFD,EAIAK,IAAI,CAACP,EAAL,CAAQ,QAAR,CAAkB,SAACH,aAAD,CAAmB,CACjCR,SAAS,CAACS,OAAV,CAAkBC,SAAlB,CAA8BF,aAA9B,CACH,CAFD,EAIAU,IAAI,CAACH,MAAL,CAAYxB,IAAI,CAACwB,MAAjB,EAEAd,aAAa,CAACQ,OAAd,CAAwBS,IAAxB,CACH,CAhBD,CAkBA;AACA,GAAMM,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACZ,EAAD,CAAQ,CACrB,GAAMM,CAAAA,IAAI,CAAG,GAAIpC,CAAAA,IAAJ,CAAS,CAAEqC,SAAS,CAAE,IAAb,CAAmBC,OAAO,CAAE,KAA5B,CAAmCjC,MAAM,CAANA,MAAnC,CAAT,CAAb,CAEA+B,IAAI,CAACP,EAAL,CAAQ,QAAR,CAAkB,SAACU,IAAD,CAAU,CACxBrC,MAAM,CAACsC,IAAP,CAAY,UAAZ,CAAwB,CAAEG,UAAU,CAAEb,EAAd,CAAkBc,UAAU,CAAEL,IAA9B,CAAoCR,IAAI,CAAExB,EAA1C,CAA8CQ,IAAI,CAAJA,IAA9C,CAAxB,EACH,CAFD,EAIAqB,IAAI,CAACP,EAAL,CAAQ,QAAR,CAAkB,SAACH,aAAD,CAAmB,CACjCR,SAAS,CAACS,OAAV,CAAkBC,SAAlB,CAA8BF,aAA9B,CACH,CAFD,EAIAxB,MAAM,CAAC2B,EAAP,CAAU,cAAV,CAA0B,SAACI,MAAD,CAAY,CAClCrB,eAAe,CAAC,IAAD,CAAf,CAEAwB,IAAI,CAACH,MAAL,CAAYA,MAAZ,EACH,CAJD,EAMAd,aAAa,CAACQ,OAAd,CAAwBS,IAAxB,CACH,CAlBD,CAoBA;AACA,GAAMS,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACpB/B,YAAY,CAAC,IAAD,CAAZ,CACAK,aAAa,CAACQ,OAAd,CAAsBmB,OAAtB,GACAC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GACH,CAJD,CAMA,mBACI,KAAC,aAAD,CAAe,QAAf,EAAwB,KAAK,CAAE,CAC3BxC,IAAI,CAAJA,IAD2B,CACrBE,YAAY,CAAZA,YADqB,CACPE,SAAS,CAATA,SADO,CACKN,EAAE,CAAFA,EADL,CACSU,OAAO,CAAPA,OADT,CACkBC,SAAS,CAATA,SADlB,CAC6Bb,MAAM,CAANA,MAD7B,CACqCU,IAAI,CAAJA,IADrC,CAC2CC,OAAO,CAAPA,OAD3C,CACoD0B,QAAQ,CAARA,QADpD,CAC8DG,SAAS,CAATA,SAD9D,CACyEV,UAAU,CAAVA,UADzE,CAA/B,UAGK/B,QAHL,EADJ,CAOH,CApFD,CAsFA,OAAQD,eAAR,CAAwBF,aAAxB","sourcesContent":["import React, { createContext, useState, useRef, useEffect } from \"react\";\r\nimport { io } from \"socket.io-client\";\r\nimport Peer from \"simple-peer\";\r\n\r\nconst SocketContext = createContext();\r\n\r\nconst socket = io(\"https://zoom-clone-back.herokuapp.com/\");\r\n\r\nconst ContextProvider = ({ children }) => {\r\n\r\n    const [stream, setStream] = useState(null);\r\n    const [me, setMe] = useState(\"\");\r\n    const [call, setCall] = useState({});\r\n    const [callAccepted, setCallAccepted] = useState(false);\r\n    const [callEnded, setCallEnded] = useState(false);\r\n    const [name, setName] = useState(\"\");\r\n\r\n    const myVideo = useRef();\r\n    const userVideo = useRef();\r\n    const connectionRef = useRef();\r\n\r\n    //to get the permission for the audio and video and to stream\r\n    useEffect(() => {\r\n        navigator.mediaDevices.getUserMedia({ video: true, audio: true })\r\n            .then((currentStream) => {\r\n                setStream(currentStream);\r\n                myVideo.current.srcObject = currentStream;\r\n            })\r\n\r\n        socket.on(\"me\", (id) => {\r\n            setMe(id);\r\n        })\r\n\r\n        socket.on(\"calluser\", ({ from, name: callerName, signal }) => {\r\n            setCall({ isReceivedCall: true, from, name: callerName, signal })\r\n        })\r\n    }, []);\r\n\r\n    //streaming\r\n    const answerCall = () => {\r\n        setCallAccepted(true)\r\n\r\n        const peer = new Peer({ initiator: false, trickle: false, stream });\r\n\r\n        peer.on(\"signal\", (data) => {\r\n            socket.emit(\"answerCall\", { signal: data, to: call.from });\r\n        });\r\n\r\n        peer.on(\"stream\", (currentStream) => {\r\n            userVideo.current.srcObject = currentStream;\r\n        });\r\n\r\n        peer.signal(call.signal);\r\n\r\n        connectionRef.current = peer;\r\n    }\r\n\r\n    //for streaming \r\n    const callUser = (id) => {\r\n        const peer = new Peer({ initiator: true, trickle: false, stream });\r\n\r\n        peer.on(\"signal\", (data) => {\r\n            socket.emit(\"calluser\", { userToCall: id, signalData: data, from: me, name });\r\n        });\r\n\r\n        peer.on(\"stream\", (currentStream) => {\r\n            userVideo.current.srcObject = currentStream;\r\n        });\r\n\r\n        socket.on(\"callaccepted\", (signal) => {\r\n            setCallAccepted(true);\r\n\r\n            peer.signal(signal);\r\n        });\r\n\r\n        connectionRef.current = peer;\r\n    }\r\n\r\n    //to disconnect the call\r\n    const leaveCall = () => {\r\n        setCallEnded(true);\r\n        connectionRef.current.destroy();\r\n        window.location.reload();\r\n    }\r\n\r\n    return (\r\n        <SocketContext.Provider value={{\r\n            call, callAccepted, callEnded,  me, myVideo, userVideo, stream, name, setName, callUser, leaveCall, answerCall\r\n        }}>\r\n            {children}\r\n        </SocketContext.Provider>\r\n    );\r\n}\r\n\r\nexport {ContextProvider,SocketContext};"]},"metadata":{},"sourceType":"module"}